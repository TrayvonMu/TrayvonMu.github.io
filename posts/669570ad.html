<!DOCTYPE html><html class="theme-next mist use-motion" lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="Weblogic,CVE,漏洞复现,"><link rel="alternate" href="/atom.xml" title="Tr4yv0n's Blog" type="application/atom+xml"><meta name="description" content="Weblogic由WLS Security子组件对外部提供Webservice服务，其中使用了XMLDecoder来解析用户传入的数据，在解析过程中间出现反序列化漏洞，导致可以进行任意命令的执行，由此导致了CVE-2017-3506 &amp;amp; CVE-2017-10271的产生。  0x00 环境准备 Windows 10 x64 Docker CE for Windows IntelliJ I"><meta name="keywords" content="Weblogic,CVE,漏洞复现"><meta property="og:type" content="article"><meta property="og:title" content="Weblogic反序列化漏洞初探"><meta property="og:url" content="http://trayvon.me/posts/669570ad.html"><meta property="og:site_name" content="Tr4yv0n&#39;s Blog"><meta property="og:description" content="Weblogic由WLS Security子组件对外部提供Webservice服务，其中使用了XMLDecoder来解析用户传入的数据，在解析过程中间出现反序列化漏洞，导致可以进行任意命令的执行，由此导致了CVE-2017-3506 &amp;amp; CVE-2017-10271的产生。  0x00 环境准备 Windows 10 x64 Docker CE for Windows IntelliJ I"><meta property="og:locale" content="zh-Hans"><meta property="og:image" content="http://trayvon.me/image/2018-10-31/2018-10-31-1.PNG"><meta property="og:image" content="http://trayvon.me/image/2018-10-31/2018-10-31-2.PNG"><meta property="og:image" content="http://trayvon.me/image/2018-10-31/2018-10-31-3.PNG"><meta property="og:image" content="http://trayvon.me/image/2018-10-31/2018-10-31-4.PNG"><meta property="og:image" content="http://trayvon.me/image/2018-10-31/2018-10-31-5.PNG"><meta property="og:image" content="http://trayvon.me/image/2018-10-31/2018-10-31-6.PNG"><meta property="og:image" content="http://trayvon.me/image/2018-10-31/2018-10-31-7.PNG"><meta property="og:image" content="http://trayvon.me/image/2018-10-31/2018-10-31-8.PNG"><meta property="og:image" content="http://trayvon.me/image/2018-10-31/2018-10-31-9.PNG"><meta property="og:image" content="http://trayvon.me/image/2018-10-31/2018-10-31-18.PNG"><meta property="og:image" content="http://trayvon.me/image/2018-10-31/2018-10-31-11.PNG"><meta property="og:image" content="http://trayvon.me/image/2018-10-31/2018-10-31-12.PNG"><meta property="og:image" content="http://trayvon.me/image/2018-10-31/2018-10-31-13.PNG"><meta property="og:image" content="http://trayvon.me/image/2018-10-31/2018-10-31-14.PNG"><meta property="og:image" content="http://trayvon.me/image/2018-10-31/2018-10-31-15.PNG"><meta property="og:image" content="http://trayvon.me/image/2018-10-31/2018-10-31-16.PNG"><meta property="og:image" content="http://trayvon.me/image/2018-10-31/2018-10-31-17.PNG"><meta property="og:image" content="http://trayvon.me/image/2018-10-31/2018-10-31-18.PNG"><meta property="og:updated_time" content="2018-11-01T11:52:42.628Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Weblogic反序列化漏洞初探"><meta name="twitter:description" content="Weblogic由WLS Security子组件对外部提供Webservice服务，其中使用了XMLDecoder来解析用户传入的数据，在解析过程中间出现反序列化漏洞，导致可以进行任意命令的执行，由此导致了CVE-2017-3506 &amp;amp; CVE-2017-10271的产生。  0x00 环境准备 Windows 10 x64 Docker CE for Windows IntelliJ I"><meta name="twitter:image" content="http://trayvon.me/image/2018-10-31/2018-10-31-1.PNG"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",version:"5.1.4",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:"trues",onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://trayvon.me/posts/669570ad.html"><title>Weblogic反序列化漏洞初探 | Tr4yv0n's Blog</title><style>.forkme{display:none}@media (min-width:768px){.forkme{display:inline}}</style></head><body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><div class="forkme"> <a href="https://github.com/share-codes" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#70b7fd;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style></div><header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Tr4yv0n's Blog</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle"></p></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> 归档</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br> 搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"> <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://trayvon.me/posts/669570ad.html"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Trayvon"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Tr4yv0n's Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Weblogic反序列化漏洞初探</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-10-31T20:04:55+08:00">2018-10-31</time></span></div></header><div class="post-body" itemprop="articleBody"><p><strong>Weblogic由WLS Security子组件对外部提供Webservice服务，其中使用了XMLDecoder来解析用户传入的数据，在解析过程中间出现反序列化漏洞，导致可以进行任意命令的执行，由此导致了CVE-2017-3506 &amp; CVE-2017-10271的产生。</strong></p><hr><h1 id="0x00-环境准备"><a href="#0x00-环境准备" class="headerlink" title="0x00 环境准备"></a>0x00 环境准备</h1><ul><li><strong>Windows 10 x64</strong></li><li><strong>Docker CE for Windows</strong></li><li><strong>IntelliJ IDEA</strong></li></ul><p>在Github上的<a href="https://github.com/vulhub/vulhub" target="_blank" rel="noopener">Vulhub</a>是一个面向大众的开源漏洞靶场，因此可以利用现成的<a href="https://github.com/vulhub/vulhub" target="_blank" rel="noopener">Vulhub</a>中的<code>docker-compose.yml</code>进行环境搭建，具体操作步骤可以参照<code>Vulhub</code>相应的描述文件，内容十分详尽，感谢Vulhub大佬们的贡献，为萌新剩下了不少造轮子的时间。</p><p>由于需要在宿主机进行本地调试，除了本来打开的<code>7001</code>端口之外，还需要开放一个远端调试端口，所以应该改动一下<code>docker-compose.yml</code>开放8453端口，修改完的内容如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">version: &apos;2&apos;</span><br><span class="line">services:</span><br><span class="line"> weblogic:</span><br><span class="line">   image: vulhub/weblogic</span><br><span class="line">   ports:</span><br><span class="line">    - &quot;7001:7001&quot;</span><br><span class="line">    - &quot;8453:8453&quot;</span><br></pre></td></tr></table></figure><p>启动镜像中间我个人碰到了一些奇怪的问题，导致端口一直打不开，最后发现将配置文件修改如下后，镜像启动正常,很迷。</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">version:</span> <span class="string">'2'</span></span><br><span class="line"><span class="attr">services:</span></span><br><span class="line"><span class="attr"> weblogic:</span></span><br><span class="line"><span class="attr">   image:</span> <span class="string">vulhub/weblogic</span></span><br><span class="line"><span class="attr">   ports:</span></span><br><span class="line"><span class="bullet">    -</span> <span class="number">7001</span><span class="string">:7001</span></span><br><span class="line"><span class="bullet">    -</span> <span class="number">8453</span><span class="string">:8453</span></span><br></pre></td></tr></table></figure><p>最后在Docker中<code>docker-compose up -d</code>完成搭建。</p><p>Docker搭建完成后，使用命令<code>docker exec -it weblogic bash</code>进入docker容器，修改<code>/root/Oracle/Middleware/user_projects/domains/base_domain/bin/setDomainEnv.sh</code>文件，找到以下代码段</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> [ <span class="string">"$&#123;debugFlag&#125;"</span> = <span class="string">"true"</span> ] ; then</span><br><span class="line">        JAVA_DEBUG=<span class="string">"-Xdebug -Xnoagent -Xrunjdwp:transport=dt_socket,address=$&#123;DEBUG_PORT&#125;,server=y,suspend=n -Djava.compiler=NONE"</span></span><br><span class="line">        export JAVA_DEBUG</span><br><span class="line">        JAVA_OPTIONS=<span class="string">"$&#123;JAVA_OPTIONS&#125; $&#123;enableHotswapFlag&#125; -ea -da:com.bea... -da:javelin... -da:weblogic... -ea:com.bea.wli... -ea:com.bea.broker... -ea:com.bea.sbconsole..."</span></span><br><span class="line">        export JAVA_OPTIONS</span><br></pre></td></tr></table></figure><p>在其前面添加：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">debugFlag=<span class="string">"true"</span></span><br><span class="line">expport debugFlag</span><br></pre></td></tr></table></figure><p>运行<code>exit</code>退出容器，重启容器。使用命令<code>docker ps</code>查看容器运行情况。</p><p>由于要在宿主机远程调试Weblogic，而weblogic是没有源码的，所以需要把相关依赖也一并拷出来。</p><p><code>docker cp weblogic:/root/Oracle/Middleware/wlserver_10.3 ./wlserver_10.3</code></p><p>但会报出如下错误：</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open D:\Docker\vulhub\weblogic\CVE-<span class="number">2017</span>-<span class="number">10271</span>\wlserver_10.<span class="number">3</span>\samples\server\medrec\modules\physician\assembly\target\exploded\physician\physician-jaxrpc-facade-client-broker\WEB-INF\classes\com\bea\physician\facade\broker\jaxrpc\JaxRpcRecordCreationFacadeClientBroker.class: The system cannot find the path specified.</span><br></pre></td></tr></table></figure><p>查找结果如下：</p><p><img src="\image\2018-10-31\2018-10-31-1.PNG" alt=""></p><p>由于微软对于命令行下的路径长度限制，拷贝行为会报错并结束。</p><p>可以使用linux打包命令：<code>zip -r zipname.zip /targetdir</code></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zip -r wlserver_10.3.zip /wlserver_10.3</span><br></pre></td></tr></table></figure><p>这部分jar包不全，还要将Docker中，<code>/root/Oracle/Middleware/modules</code>给拷出来，然后全部扔进刚才复制到宿主机的<code>wlserver_10.3/server/lib</code>目录下。</p><hr><h1 id="0x01-远程调试"><a href="#0x01-远程调试" class="headerlink" title="0x01 远程调试"></a>0x01 远程调试</h1><p>使用idea打开wlserver_10.3，将server/lib文件夹添加到library。</p><p><img src="\image\2018-10-31\2018-10-31-2.PNG" alt=""></p><p>添加完后，就会发现里面的.jar和.war的包都可以点开了。并且可以搜索里面的一些类和字符串了。然后设置debug，添加一个Remote配置：</p><p><img src="\image\2018-10-31\2018-10-31-3.PNG" alt=""></p><p>端口设置为8453，并且设置module classpath：</p><p><img src="\image\2018-10-31\2018-10-31-4.PNG" alt=""></p><p>点击debug，出现如下字样，说明已经配置ok。</p><p>在wlserver_10.3/server/lib/weblogic.jar!/weblogic/wsee/jaxws/WLSServletAdapter.class中的handle方法下断点，看看能否击中断点。</p><p><img src="\image\2018-10-31\2018-10-31-5.PNG" alt=""></p><hr><h1 id="0x02-漏洞复现"><a href="#0x02-漏洞复现" class="headerlink" title="0x02 漏洞复现"></a>0x02 漏洞复现</h1><p>测试使用的POC如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">POST /wls-wsat/CoordinatorPortType HTTP/1.1</span><br><span class="line">Host: 127.0.0.1:7001</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line">User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.84 Safari/537.36</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9,en;q=0.8,zh-TW;q=0.7</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: text/xml</span><br><span class="line">Content-Length: 769</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">soapenv:Envelope</span> <span class="attr">xmlns:soapenv</span>=<span class="string">"http://schemas.xmlsoap.org/soap/envelope/"</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">soapenv:Header</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">work:WorkContext</span> <span class="attr">xmlns:work</span>=<span class="string">"http://bea.com/2004/06/soap/workarea/"</span>&gt;</span>  </span><br><span class="line">      <span class="tag">&lt;<span class="name">java</span>&gt;</span> </span><br><span class="line">        <span class="tag">&lt;<span class="name">void</span> <span class="attr">class</span>=<span class="string">"java.lang.ProcessBuilder"</span>&gt;</span> </span><br><span class="line">          <span class="tag">&lt;<span class="name">array</span> <span class="attr">class</span>=<span class="string">"java.lang.String"</span> <span class="attr">length</span>=<span class="string">"3"</span>&gt;</span> </span><br><span class="line">            。。。。</span><br><span class="line">          <span class="tag">&lt;<span class="name">void</span> <span class="attr">method</span>=<span class="string">"start"</span>/&gt;</span> </span><br><span class="line">        <span class="tag">&lt;/<span class="name">void</span>&gt;</span> </span><br><span class="line">      <span class="tag">&lt;/<span class="name">java</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;/<span class="name">work:WorkContext</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">soapenv:Header</span>&gt;</span>  </span><br><span class="line">  <span class="tag">&lt;<span class="name">soapenv:Body</span>/&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">soapenv:Envelope</span>&gt;</span></span><br></pre></td></tr></table></figure><p>对于poc中uri中<code>/wls-wsat/CoordinatorPortType</code> 可以换成CoordinatorPortType11等wsat 这个webservice服务中存在的其他uri。</p><p>由于在docker中，就只是利用权限进行了文件写入。</p><p>执行的效果图如下：</p><p><img src="\image\2018-10-31\2018-10-31-6.PNG" alt=""></p><p><img src="\image\2018-10-31\2018-10-31-7.PNG" alt=""></p><hr><h1 id="0x03-动态分析"><a href="#0x03-动态分析" class="headerlink" title="0x03 动态分析"></a>0x03 动态分析</h1><p>根据poc内容可知，此次漏洞出现在<code>wls-wsat.war</code>中，构造SOAP（XML）格式的请求，在解析的过程中导致XMLDecoder反序列化漏洞</p><p>在IDEA中搜索<code>wls-wsat.war</code>。打开后点击<code>web.xml</code>查看有哪些接口</p><p><img src="\image\2018-10-31\2018-10-31-8.PNG" alt=""></p><p>第一个就是所需要的接口。由于<code>WebLogic servlet</code>的分发机制复杂，先放在一边。</p><p>根据网上大佬们已有分析，我只是跟一下流程：</p><p>从processRequest开始被xml逻辑处理，输入中的readUTF中被反序列化。以下是函数调用栈：</p><p><img src="\image\2018-10-31\2018-10-31-9.PNG" alt=""></p><p><img src="\image\2018-10-31\2018-10-31-18.PNG" alt=""></p><h2 id="具体分析流程如下："><a href="#具体分析流程如下：" class="headerlink" title="具体分析流程如下："></a>具体分析流程如下：</h2><h3 id="weblogic-wsee-jaxws-WLSServletAdapter-class"><a href="#weblogic-wsee-jaxws-WLSServletAdapter-class" class="headerlink" title="weblogic.wsee.jaxws.WLSServletAdapter.class"></a>weblogic.wsee.jaxws.WLSServletAdapter.class</h3><p><img src="\image\2018-10-31\2018-10-31-11.PNG" alt=""></p><p>请求先会进入handel方法，handel方法又会执行super.handle(var1, var2, var3);方法，这个方法对servlet的容器和request和response进行了封装。</p><p>继续跟进</p><p><img src="\image\2018-10-31\2018-10-31-12.PNG" alt=""></p><p>先会对var1的内容判断是否为空，不为空的话，会取出xml中的header，也就是我们poc中的:</p><p><img src="\image\2018-10-31\2018-10-31-13.PNG" alt=""></p><h3 id="weblogic-wsee-jaxws-workcontext-WorkContextTube"><a href="#weblogic-wsee-jaxws-workcontext-WorkContextTube" class="headerlink" title="weblogic.wsee.jaxws.workcontext.WorkContextTube"></a>weblogic.wsee.jaxws.workcontext.WorkContextTube</h3><p><img src="\image\2018-10-31\2018-10-31-14.PNG" alt=""></p><p>继续跟进receive()</p><h3 id="weblogic-workarea-WorkContextMapImpl"><a href="#weblogic-workarea-WorkContextMapImpl" class="headerlink" title="weblogic.workarea.WorkContextMapImpl"></a>weblogic.workarea.WorkContextMapImpl</h3><p><img src="\image\2018-10-31\2018-10-31-15.PNG" alt=""></p><p>将数据传到下一个receiveRequest。</p><h3 id="weblogic-workarea-WorkContextLocalMap"><a href="#weblogic-workarea-WorkContextLocalMap" class="headerlink" title="weblogic.workarea.WorkContextLocalMap"></a>weblogic.workarea.WorkContextLocalMap</h3><p><img src="\image\2018-10-31\2018-10-31-16.PNG" alt=""></p><p><code>WorkContextEntryImpl.readEntry(var1)</code>对传进来的数据进行处理，继续跟进</p><h3 id="weblogic-workarea-spi-WorkContextEntryImpl"><a href="#weblogic-workarea-spi-WorkContextEntryImpl" class="headerlink" title="weblogic.workarea.spi.WorkContextEntryImpl"></a>weblogic.workarea.spi.WorkContextEntryImpl</h3><p><img src="\image\2018-10-31\2018-10-31-17.PNG" alt=""></p><p> 继续跟进WorkContextEntryImpl中的readEntry方法中，对var0进行了readUTF()方法。</p><h3 id="weblogic-wsee-workarea-WorkContextXmlInputAdapter-class"><a href="#weblogic-wsee-workarea-WorkContextXmlInputAdapter-class" class="headerlink" title="weblogic.wsee.workarea.WorkContextXmlInputAdapter.class"></a>weblogic.wsee.workarea.WorkContextXmlInputAdapter.class</h3><p><img src="\image\2018-10-31\2018-10-31-18.PNG" alt=""></p><p>发现最终执行了readObject方法，对XMLDecoder对象进行了反序列化，导致了远程命令执行。</p><hr><h1 id="0x04-漏洞原因"><a href="#0x04-漏洞原因" class="headerlink" title="0x04 漏洞原因"></a>0x04 漏洞原因</h1><p>Weblogic没有对XML的数据进行任何的过滤，导致可以构造XML数据，通过反序列化任意对象，进行任意命令的执行，这就导致了CVE-2017-3506漏洞的产生。</p><hr><h1 id="0x05-Exploit"><a href="#0x05-Exploit" class="headerlink" title="0x05 Exploit"></a>0x05 Exploit</h1><p>暂无</p><hr><h1 id="0x06-后记"><a href="#0x06-后记" class="headerlink" title="0x06 后记"></a>0x06 后记</h1><p>参考网上现有复现资料的分析做出了分析报告，在第一次做漏洞复现的时候也踩了不少坑遇到了一些困难，感谢周围师傅们的帮忙和鼓励。第一次写复现博客，感觉自己在动手写分析是发现了一些没注意问题或者本来毫无概念性的东西，对于复现过程和漏洞都有较之前有了初步的了解，同时也深感自己知识能力有所欠缺，继续努力。</p><hr><h1 id="0x07-参考链接"><a href="#0x07-参考链接" class="headerlink" title="0x07 参考链接"></a>0x07 参考链接</h1><p><a href="https://paper.seebug.org/487/" target="_blank" rel="noopener">Weblogic XMLDecoder RCE分析</a></p><p><a href="https://www.anquanke.com/post/id/102768" target="_blank" rel="noopener">CVE-2017-10271 Weblogic XMLDecoder反序化分析</a></p><p><a href="https://zhuanlan.zhihu.com/p/32301092" target="_blank" rel="noopener">CVE-2017-3506 &amp; 10271：Weblogic 远程代码执行漏洞分析及复现笔记</a></p><p><a href="http://xxlegend.com/2017/12/22/Weblogic%20CVE-2017-10271%20XMLDecoder%20RCE%E5%88%86%E6%9E%90/" target="_blank" rel="noopener">Weblogic XMLDecoder RCE分析</a></p><p><a href="http://whip1ash.cn/2018/10/21/weblogic-deserialization" target="_blank" rel="noopener">从0开始学习WebLogic(Java)反序列化 (1)</a></p></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/Weblogic/" rel="tag"># Weblogic</a> <a href="/tags/CVE/" rel="tag"># CVE</a> <a href="/tags/漏洞复现/" rel="tag"># 漏洞复现</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/posts/eb1c71d3.html" rel="next" title="Windows下生成https证书"><i class="fa fa-chevron-left"></i> Windows下生成https证书</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/posts/2308731.html" rel="prev" title="YFCTFwriteup">YFCTFwriteup<i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap"> 站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="Trayvon"><p class="site-author-name" itemprop="name">Trayvon</p><p class="site-description motion-element" itemprop="description">如今的现在可曾是当初的未来</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">8</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">11</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/share-codes" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:woaiguawa1314@gmail.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://twitter.com/Trayvon_Mu" target="_blank" title="Twitter"><i class="fa fa-fw fa-twitter"></i> Twitter</a></span></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#0x00-环境准备"><span class="nav-number">1.</span> <span class="nav-text">0x00 环境准备</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x01-远程调试"><span class="nav-number">2.</span> <span class="nav-text">0x01 远程调试</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x02-漏洞复现"><span class="nav-number">3.</span> <span class="nav-text">0x02 漏洞复现</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x03-动态分析"><span class="nav-number">4.</span> <span class="nav-text">0x03 动态分析</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#具体分析流程如下："><span class="nav-number">4.1.</span> <span class="nav-text">具体分析流程如下：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#weblogic-wsee-jaxws-WLSServletAdapter-class"><span class="nav-number">4.1.1.</span> <span class="nav-text">weblogic.wsee.jaxws.WLSServletAdapter.class</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#weblogic-wsee-jaxws-workcontext-WorkContextTube"><span class="nav-number">4.1.2.</span> <span class="nav-text">weblogic.wsee.jaxws.workcontext.WorkContextTube</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#weblogic-workarea-WorkContextMapImpl"><span class="nav-number">4.1.3.</span> <span class="nav-text">weblogic.workarea.WorkContextMapImpl</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#weblogic-workarea-WorkContextLocalMap"><span class="nav-number">4.1.4.</span> <span class="nav-text">weblogic.workarea.WorkContextLocalMap</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#weblogic-workarea-spi-WorkContextEntryImpl"><span class="nav-number">4.1.5.</span> <span class="nav-text">weblogic.workarea.spi.WorkContextEntryImpl</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#weblogic-wsee-workarea-WorkContextXmlInputAdapter-class"><span class="nav-number">4.1.6.</span> <span class="nav-text">weblogic.wsee.workarea.WorkContextXmlInputAdapter.class</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x04-漏洞原因"><span class="nav-number">5.</span> <span class="nav-text">0x04 漏洞原因</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x05-Exploit"><span class="nav-number">6.</span> <span class="nav-text">0x05 Exploit</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x06-后记"><span class="nav-number">7.</span> <span class="nav-text">0x06 后记</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x07-参考链接"><span class="nav-number">8.</span> <span class="nav-text">0x07 参考链接</span></a></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright"> &copy; <span itemprop="copyrightYear">2019</span><span class="with-love"><i class="fa fa-"></i></span> <span class="author" itemprop="copyrightHolder">Trayvon</span></div><div class="powered-by"><i class="fa fa-user-md"></i> <span id="busuanzi_container_site_uv">Unique Visitors:<span id="busuanzi_value_site_uv"></span></span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script><script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script><script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script><script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><script>var browser={versions:function(){var e=navigator.userAgent;navigator.appVersion;return{trident:-1<e.indexOf("Trident"),presto:-1<e.indexOf("Presto"),webKit:-1<e.indexOf("AppleWebKit"),gecko:-1<e.indexOf("Gecko")&&-1==e.indexOf("KHTML"),mobile:!!e.match(/AppleWebKit.*Mobile.*/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:-1<e.indexOf("Android")||-1<e.indexOf("Linux"),iPhone:-1<e.indexOf("iPhone"),iPad:-1<e.indexOf("iPad"),webApp:-1==e.indexOf("Safari")}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()};browser.versions.mobile||browser.versions.ios||browser.versions.android||browser.versions.iPhone||browser.versions.iPad||document.write("<script type='text/javascript'  src='/js/src/particle.js'><\/script>")</script><script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",model:{jsonPath:"live2d-widget-model-hijiki"},display:{position:"right",width:100,height:200},mobile:{show:!0},log:!1,tagMode:!1})</script></body></html>