<!DOCTYPE html><html class="theme-next mist use-motion" lang="zh-Hans"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" content="#222"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"><link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css"><link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4"><link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222"><meta name="keywords" content="web,信息收集,渗透,"><link rel="alternate" href="/atom.xml" title="Tr4yv0n's Blog" type="application/atom+xml"><meta name="description" content="1.收集域名信息DNS、注册人、备案等有关域名的一切信息。 收集方式Whois：站长之家，爱站网等； 备案：天眼查、ICP备案查询网等； 敏感字收集：Google Google用法 Site ————指定域名 Inurl————URL中的关键字 Intext———-网页正文中的关键字 Filetype——-指定的文件类型 Intitle———-网页标题中的关键字 link————-link:bai"><meta name="keywords" content="web,信息收集,渗透"><meta property="og:type" content="article"><meta property="og:title" content="信息收集"><meta property="og:url" content="http://trayvon.me/posts/312e3d12.html"><meta property="og:site_name" content="Tr4yv0n&#39;s Blog"><meta property="og:description" content="1.收集域名信息DNS、注册人、备案等有关域名的一切信息。 收集方式Whois：站长之家，爱站网等； 备案：天眼查、ICP备案查询网等； 敏感字收集：Google Google用法 Site ————指定域名 Inurl————URL中的关键字 Intext———-网页正文中的关键字 Filetype——-指定的文件类型 Intitle———-网页标题中的关键字 link————-link:bai"><meta property="og:locale" content="zh-Hans"><meta property="og:updated_time" content="2019-05-19T09:23:17.197Z"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="信息收集"><meta name="twitter:description" content="1.收集域名信息DNS、注册人、备案等有关域名的一切信息。 收集方式Whois：站长之家，爱站网等； 备案：天眼查、ICP备案查询网等； 敏感字收集：Google Google用法 Site ————指定域名 Inurl————URL中的关键字 Intext———-网页正文中的关键字 Filetype——-指定的文件类型 Intitle———-网页标题中的关键字 link————-link:bai"><script type="text/javascript" id="hexo.configurations">var NexT=window.NexT||{},CONFIG={root:"/",scheme:"Mist",version:"5.1.4",sidebar:{position:"left",display:"post",offset:12,b2t:!1,scrollpercent:"trues",onmobile:!1},fancybox:!0,tabs:!0,motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},duoshuo:{userId:"0",author:"博主"},algolia:{applicationID:"",apiKey:"",indexName:"",hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}}}</script><link rel="canonical" href="http://trayvon.me/posts/312e3d12.html"><title>信息收集 | Tr4yv0n's Blog</title><style>.forkme{display:none}@media (min-width:768px){.forkme{display:inline}}</style></head><body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans"><div class="container sidebar-position-left page-post-detail"><div class="headband"></div><div class="forkme"> <a href="https://github.com/share-codes" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#70b7fd;color:#fff;position:absolute;top:0;border:0;right:0" aria-hidden="true"><path d="M0 0 115 115 130 115 142 142 250 250 250 0Z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4L133.7 101.6C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style></div><header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-wrapper"><div class="site-meta"><div class="custom-logo-site-title"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span> <span class="site-title">Tr4yv0n's Blog</span><span class="logo-line-after"><i></i></span></a></div><p class="site-subtitle"></p></div><div class="site-nav-toggle"> <button><span class="btn-bar"></span><span class="btn-bar"></span><span class="btn-bar"></span></button></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i><br> 首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i><br> 关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i><br> 标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i><br> 分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i><br> 归档</a></li><li class="menu-item menu-item-search"><a href="javascript:;" class="popup-trigger"><i class="menu-item-icon fa fa-search fa-fw"></i><br> 搜索</a></li></ul><div class="site-search"><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class="search-icon"><i class="fa fa-search"></i></span><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span><div class="local-search-input-wrapper"> <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input"></div></div><div id="local-search-result"></div></div></div></nav></div></header><main id="main" class="main"><div class="main-inner"><div class="content-wrap"><div id="content" class="content"><div id="posts" class="posts-expand"><article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article"><div class="post-block"><link itemprop="mainEntityOfPage" href="http://trayvon.me/posts/312e3d12.html"><span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person"><meta itemprop="name" content="Trayvon"><meta itemprop="description" content=""><meta itemprop="image" content="/images/avatar.png"></span><span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization"><meta itemprop="name" content="Tr4yv0n's Blog"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">信息收集</h1><div class="post-meta"><span class="post-time"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i></span> <span class="post-meta-item-text">发表于</span> <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-05-19T16:08:34+08:00">2019-05-19</time></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="1-收集域名信息"><a href="#1-收集域名信息" class="headerlink" title="1.收集域名信息"></a>1.收集域名信息</h1><p><strong>DNS、注册人、备案等有关域名的一切信息。</strong></p><h2 id="收集方式"><a href="#收集方式" class="headerlink" title="收集方式"></a>收集方式</h2><p>Whois：站长之家，爱站网等；</p><p>备案：天眼查、ICP备案查询网等；</p><p>敏感字收集：Google</p><h2 id="Google用法"><a href="#Google用法" class="headerlink" title="Google用法"></a>Google用法</h2><ul><li>Site ————指定域名</li><li>Inurl————URL中的关键字</li><li>Intext———-网页正文中的关键字</li><li>Filetype——-指定的文件类型</li><li>Intitle———-网页标题中的关键字</li><li>link————-link:baidu.com表示有和baidu.com连接的URL</li><li>Info ————查找指定站点的基本信息</li><li>Cache———-搜索Google里有关某些内容的缓存</li></ul><p>例：site: edu.cn intext: 后台管理</p><h2 id="子域名信息收集"><a href="#子域名信息收集" class="headerlink" title="子域名信息收集"></a>子域名信息收集</h2><p>Layer子域名挖掘机等</p><h2 id="扫描端口"><a href="#扫描端口" class="headerlink" title="扫描端口"></a>扫描端口</h2><p>扫描端口：Nmap，无状态端口扫描工具Masscan，御剑高速TCP端口扫描工具等</p><h3 id="常见的端口信息"><a href="#常见的端口信息" class="headerlink" title="常见的端口信息"></a>常见的端口信息</h3><table><thead><tr><th>端口</th><th>端口说明</th><th>攻击方向</th></tr></thead><tbody><tr><td><strong>文件共享服务端口：</strong></td><td></td><td></td></tr><tr><td>21/22/69</td><td>Ftp/Tftp文件传输协议</td><td>允许匿名上传、下载、爆破和嗅探操作</td></tr><tr><td>2049</td><td>Nfs服务</td><td>配置不当</td></tr><tr><td>139</td><td>Samba服务</td><td>爆破、未经授权访问、远程代码执行</td></tr><tr><td>389</td><td>Ldap目录访问协议</td><td>注入、允许匿名访问、弱口令</td></tr><tr><td><strong>远程链接服务端口：</strong></td><td></td><td></td></tr><tr><td>22</td><td>SSH远程链接</td><td>爆破、SSH隧道及内网代理转发、文件传输</td></tr><tr><td>23</td><td>Telnet远程连接</td><td>爆破、嗅探、弱口令</td></tr><tr><td>3398</td><td>Rdp远程桌面连接</td><td>爆破、嗅探、弱口令</td></tr><tr><td><strong>Server 2003以下的系统)、爆破：</strong></td><td></td><td></td></tr><tr><td>5900</td><td>VNC</td><td>弱口令、爆破</td></tr><tr><td>5632</td><td>PyAnywhere服务</td><td>抓密码、代码执行</td></tr><tr><td><strong>Web应用服务端口：</strong></td><td></td><td></td></tr><tr><td>80/443/8080</td><td>常见的Web服务端口</td><td>Web攻击、爆破对应服务版本的漏洞</td></tr><tr><td>7001/7002</td><td>WebLogic控制台</td><td>Java反序列化、弱口令</td></tr><tr><td>8080/8089</td><td>Jboss/Resin/Jetty/Jenkins</td><td>反序列化控制台弱口令</td></tr><tr><td>9090</td><td>WebSphere控制台</td><td>Java反序列化、弱口令</td></tr><tr><td>4848</td><td>GlassFish控制台</td><td>弱口令</td></tr><tr><td>1352</td><td>Lotus domino邮电服务</td><td>弱口令、信息泄露、爆破</td></tr><tr><td>10000</td><td>Webmin-Web控制面板</td><td>弱口令</td></tr><tr><td><strong>数据库服务端口：</strong></td><td></td><td></td></tr><tr><td>3306</td><td>MYSQL</td><td>注入、提权、爆破</td></tr><tr><td>1433</td><td>MSSQL</td><td>注入、提权、SA弱口令、爆破</td></tr><tr><td>1521</td><td>Oracle数据库</td><td>TNS爆破、注入、反弹Shell</td></tr><tr><td>5432</td><td>PostgreSQL数据库</td><td>爆破、注入、弱口令</td></tr><tr><td>27017/27018</td><td>MongoDB数据库</td><td>爆破、未授权访问</td></tr><tr><td>6379</td><td>Redis数据库</td><td>可尝试未授权访问、弱口令</td></tr><tr><td>5000</td><td>SysBase/DB2数据库</td><td>可尝试未授权访问、弱口令</td></tr><tr><td><strong>邮件服务端口：</strong></td><td></td><td></td></tr><tr><td>25</td><td>SMTP邮件服务</td><td>邮件伪造</td></tr><tr><td>110</td><td>POP3协议</td><td>爆破、嗅探</td></tr><tr><td>143</td><td>IMAP协议</td><td>爆破</td></tr><tr><td><strong>网络常见协议端口：</strong></td><td></td><td></td></tr><tr><td>53</td><td>DNS域名系统</td><td>允许区域传送、DNS劫持、缓存投毒、欺骗</td></tr><tr><td>67/68</td><td>DHCP服务</td><td>劫持、欺骗</td></tr><tr><td>161</td><td>SNMP协议</td><td>爆破、搜索目标内网信息</td></tr><tr><td><strong>特殊服务端口：</strong></td><td></td><td></td></tr><tr><td>2181</td><td>Zookeeper服务</td><td>未经授权访问</td></tr><tr><td>8069</td><td>zabbix服务</td><td>远程执行、SQL注入</td></tr><tr><td>9200/9300</td><td>Elasticsearch服务</td><td>远程执行</td></tr><tr><td>11211</td><td>Memcache服务</td><td>未经授权</td></tr><tr><td>512/513/514</td><td>Linux Rexec服务</td><td>爆破、Rlogin登陆</td></tr><tr><td>873</td><td>Rsync服务</td><td>匿名访问、文件上传</td></tr><tr><td>3690</td><td>Svn服务</td><td>Svn泄露、未经授权访问</td></tr><tr><td>50000</td><td>SAP Management Console</td><td>远程执行</td></tr></tbody></table><h1 id="2-指纹识别"><a href="#2-指纹识别" class="headerlink" title="2.指纹识别"></a>2.指纹识别</h1><p>是指自动识别网址所用的CMS，常见的CMS有Dedecms(织梦)、Discuz、PHPWEB、PHPWind、PHPCMS、ECShop、Dvbbs、SiteWeaver、ASPCMS、帝国、Z-Blog、WordPress</p><h2 id="常见的指纹识别工具"><a href="#常见的指纹识别工具" class="headerlink" title="常见的指纹识别工具"></a>常见的指纹识别工具</h2><p>御剑Web指纹识别、WhatWeb、WebRobo、椰树、轻量级WEB指纹识别等</p><h2 id="在线指纹识别网址"><a href="#在线指纹识别网址" class="headerlink" title="在线指纹识别网址"></a>在线指纹识别网址</h2><ul><li>BugScaner：<a href="http://whatweb.bugscaner.com/look/" target="_blank" rel="noopener">http://whatweb.bugscaner.com/look/</a></li><li>云悉指纹：<a href="http://www.yunsee.cn/finger.html" target="_blank" rel="noopener">http://www.yunsee.cn/finger.html</a></li><li>WhatWeb：<a href="http://whatweb.net/" target="_blank" rel="noopener">http://whatweb.net/</a></li></ul><h1 id="3-查找真实的IP"><a href="#3-查找真实的IP" class="headerlink" title="3.查找真实的IP"></a>3.查找真实的IP</h1><p>在渗透过程中，目标服务可能只有一个域名。那么如何听过这个域名来确定目标服务器的真实IP对渗透测试来说就很重要。如果目标服务器不存在CDN，壳直接通过<a href="http://www.ip138.com获取目标的一些IP" target="_blank" rel="noopener">www.ip138.com</a>获取目标的一些IP及域名信息。这里主要是讲在一下这几种情况下，如何绕过CDN寻找目标服务器的真实IP。</p><h2 id="目标服务器存在CDN"><a href="#目标服务器存在CDN" class="headerlink" title="目标服务器存在CDN"></a>目标服务器存在CDN</h2><p>如果目标存在CDN则我们ping目标的域名时得到的并非真正的Web服务器，只是离我们最近的一台目标节点的CDN服务器。</p><h2 id="判断是否使用了CDN"><a href="#判断是否使用了CDN" class="headerlink" title="判断是否使用了CDN"></a>判断是否使用了CDN</h2><p>可以通过ping目标主域，观察域名解析的情况来判断还可以利用在线网址（<a href="https://www.17ce.com" target="_blank" rel="noopener">17CE.com</a>）进行全国多地区的ping服务器操作，然后对比各个地区ping出的IP结果判断，查看这些IP是否一致，如果一样的，极有可能不存在CDN，如果不太一样或者规律很强，可以尝试查找这些IP的归属地，判断是否存在CDN。</p><h2 id="绕过CDN寻找真实的IP"><a href="#绕过CDN寻找真实的IP" class="headerlink" title="绕过CDN寻找真实的IP"></a>绕过CDN寻找真实的IP</h2><p>内部邮箱：查看邮件、寻找邮件头中的邮件服务器IPping邮箱的域名（邮箱必须是自己的邮件服务器），通过网站用户注册或者RSS订阅。</p><p><em>扫描网站的测试文件：如phpinfo、test等</em>。</p><p>分站域名：可以通过ping二级域名来获取分站IP，可能会出现分站和主站不在同一个IP下但是在同一个C段下。</p><p>国外访问：国内的CDN往往支队国内用户的访问加速，而国外的CDN就不一定了。因此，通过国外在线代理网址App Svnthetic Monitor(<a href="https://asm.ca.com/en/ping.php)" target="_blank" rel="noopener">https://asm.ca.com/en/ping.php)</a>访问，可能会得到真实的IP。</p><p>查询域名解析记录：<a href="https://www.netcraft.com" target="_blank" rel="noopener">https://www.netcraft.com</a>。</p><p>网址自己的APP：是可以尝试利用Fiddler或Burp Suit抓取App的请求，从里面找到真实的IP。</p><h2 id="验证获取的IP"><a href="#验证获取的IP" class="headerlink" title="验证获取的IP"></a>验证获取的IP</h2><p>直接用IP访问或者在目标段比较打的情况下，借助类似Masscan的工具批量扫描对应IP段中所有开了80.443.8080端口的IP。然后珠峰尝试IP访问观察相应结果是否为主站点。</p></div><footer class="post-footer"><div class="post-tags"> <a href="/tags/web/" rel="tag"># web</a> <a href="/tags/信息收集/" rel="tag"># 信息收集</a> <a href="/tags/渗透/" rel="tag"># 渗透</a></div><div class="post-nav"><div class="post-nav-next post-nav-item"><a href="/posts/4f45247d.html" rel="next" title="阅读书目推荐"><i class="fa fa-chevron-left"></i> 阅读书目推荐</a></div><span class="post-nav-divider"></span><div class="post-nav-prev post-nav-item"> <a href="/posts/4a17b156.html" rel="prev" title="Hello World">Hello World<i class="fa fa-chevron-right"></i></a></div></div></footer></div></article><div class="post-spread"></div></div></div></div><div class="sidebar-toggle"><div class="sidebar-toggle-line-wrap"><span class="sidebar-toggle-line sidebar-toggle-line-first"></span><span class="sidebar-toggle-line sidebar-toggle-line-middle"></span><span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id="sidebar" class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap"> 文章目录</li><li class="sidebar-nav-overview" data-target="site-overview-wrap"> 站点概览</li></ul><section class="site-overview-wrap sidebar-panel"><div class="site-overview"><div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person"> <img class="site-author-image" itemprop="image" src="/images/avatar.png" alt="Trayvon"><p class="site-author-name" itemprop="name">Trayvon</p><p class="site-description motion-element" itemprop="description">如今的现在可曾是当初的未来</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"> <a href="/archives/"><span class="site-state-item-count">8</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-tags"> <a href="/tags/index.html"><span class="site-state-item-count">11</span> <span class="site-state-item-name">标签</span></a></div></nav><div class="feed-link motion-element"><a href="/atom.xml" rel="alternate"><i class="fa fa-rss"></i> RSS</a></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/share-codes" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i> GitHub</a></span><span class="links-of-author-item"><a href="mailto:woaiguawa1314@gmail.com" target="_blank" title="E-Mail"><i class="fa fa-fw fa-envelope"></i> E-Mail</a></span><span class="links-of-author-item"><a href="https://twitter.com/Trayvon_Mu" target="_blank" title="Twitter"><i class="fa fa-fw fa-twitter"></i> Twitter</a></span></div></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class="post-toc"><div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#1-收集域名信息"><span class="nav-number">1.</span> <span class="nav-text">1.收集域名信息</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#收集方式"><span class="nav-number">1.1.</span> <span class="nav-text">收集方式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Google用法"><span class="nav-number">1.2.</span> <span class="nav-text">Google用法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#子域名信息收集"><span class="nav-number">1.3.</span> <span class="nav-text">子域名信息收集</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#扫描端口"><span class="nav-number">1.4.</span> <span class="nav-text">扫描端口</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#常见的端口信息"><span class="nav-number">1.4.1.</span> <span class="nav-text">常见的端口信息</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#2-指纹识别"><span class="nav-number">2.</span> <span class="nav-text">2.指纹识别</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#常见的指纹识别工具"><span class="nav-number">2.1.</span> <span class="nav-text">常见的指纹识别工具</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#在线指纹识别网址"><span class="nav-number">2.2.</span> <span class="nav-text">在线指纹识别网址</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#3-查找真实的IP"><span class="nav-number">3.</span> <span class="nav-text">3.查找真实的IP</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#目标服务器存在CDN"><span class="nav-number">3.1.</span> <span class="nav-text">目标服务器存在CDN</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#判断是否使用了CDN"><span class="nav-number">3.2.</span> <span class="nav-text">判断是否使用了CDN</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#绕过CDN寻找真实的IP"><span class="nav-number">3.3.</span> <span class="nav-text">绕过CDN寻找真实的IP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#验证获取的IP"><span class="nav-number">3.4.</span> <span class="nav-text">验证获取的IP</span></a></li></ol></li></ol></div></div></section></div></aside></div></main><footer id="footer" class="footer"><div class="footer-inner"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div class="copyright"> &copy; <span itemprop="copyrightYear">2019</span><span class="with-love"><i class="fa fa-"></i></span> <span class="author" itemprop="copyrightHolder">Trayvon</span></div><div class="powered-by"><i class="fa fa-user-md"></i> <span id="busuanzi_container_site_uv">Unique Visitors:<span id="busuanzi_value_site_uv"></span></span></div></div></footer><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span id="scrollpercent"><span>0</span>%</span></div></div><script type="text/javascript">"[object Function]"!==Object.prototype.toString.call(window.Promise)&&(window.Promise=null)</script><script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script><script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script><script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script><script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script><script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script><script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script><script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script><script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script><script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script><script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script><script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><script>var browser={versions:function(){var e=navigator.userAgent;navigator.appVersion;return{trident:-1<e.indexOf("Trident"),presto:-1<e.indexOf("Presto"),webKit:-1<e.indexOf("AppleWebKit"),gecko:-1<e.indexOf("Gecko")&&-1==e.indexOf("KHTML"),mobile:!!e.match(/AppleWebKit.*Mobile.*/),ios:!!e.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:-1<e.indexOf("Android")||-1<e.indexOf("Linux"),iPhone:-1<e.indexOf("iPhone"),iPad:-1<e.indexOf("iPad"),webApp:-1==e.indexOf("Safari")}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()};browser.versions.mobile||browser.versions.ios||browser.versions.android||browser.versions.iPhone||browser.versions.iPad||document.write("<script type='text/javascript'  src='/js/src/particle.js'><\/script>")</script><script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({pluginRootPath:"live2dw/",pluginJsPath:"lib/",pluginModelPath:"assets/",model:{jsonPath:"live2d-widget-model-hijiki"},display:{position:"right",width:100,height:200},mobile:{show:!0},log:!1,tagMode:!1})</script></body></html>